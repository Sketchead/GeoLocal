"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8465],{76:(U,x,n)=>{n.d(x,{GW:()=>i,dk:()=>r,oK:()=>f});var f=(()=>{return(g=f||(f={})).Prompt="PROMPT",g.Camera="CAMERA",g.Photos="PHOTOS",f;var g})(),i=(()=>{return(g=i||(i={})).Rear="REAR",g.Front="FRONT",i;var g})(),r=(()=>{return(g=r||(r={})).Uri="uri",g.Base64="base64",g.DataUrl="dataUrl",r;var g})()},6388:(U,x,n)=>{n.d(x,{V1:()=>r,dk:()=>i.dk,oK:()=>i.oK});var f=n(7423),i=n(76);const r=(0,f.fo)("Camera",{web:()=>n.e(3954).then(n.bind(n,3954)).then(g=>new g.CameraWeb)})},8465:(U,x,n)=>{n.r(x),n.d(x,{ProfilePageModule:()=>I});var f=n(9808),i=n(4182),r=n(7590),g=n(7733),P=n(655),O=n(6388),v=n(8304),t=n(2096),h=n(7556),_=n(5083),a=n(2468);function e(c,p){if(1&c&&t._UZ(0,"ion-img",15),2&c){const o=t.oxw();t.Q6J("src",o.profile.imageURL)}}function l(c,p){1&c&&(t.TgZ(0,"div",16),t._UZ(1,"img",17),t.TgZ(2,"p",18),t._uU(3,"+"),t.qZA()())}function d(c,p){if(1&c&&t._UZ(0,"ion-img",15),2&c){const o=t.oxw(3);t.Q6J("src",o.profilePicture)}}function m(c,p){1&c&&(t.TgZ(0,"div",16),t._UZ(1,"img",17)(2,"p",18),t.qZA())}function C(c,p){1&c&&t.GkF(0)}function y(c,p){if(1&c&&(t.ynx(0),t.TgZ(1,"ion-slide"),t._UZ(2,"img",15),t.qZA(),t.BQk()),2&c){const o=p.$implicit;t.xp6(2),t.s9C("src",o,t.LSH)}}function E(c,p){if(1&c){const o=t.EpF();t.TgZ(0,"div")(1,"ion-card-header")(2,"div",20)(3,"div",21),t.NdJ("click",function(){t.CHM(o);const u=t.oxw().$implicit,M=t.oxw();return t.KtG(M.seePost(u.id))}),t.TgZ(4,"div",22)(5,"ion-avatar",23),t.YNc(6,d,1,1,"ion-img",6),t.YNc(7,m,3,0,"ng-template",null,7,t.W1O),t.qZA(),t.TgZ(9,"ion-card-title"),t._uU(10),t.qZA(),t.TgZ(11,"ion-card-subtitle"),t._uU(12),t.YNc(13,C,1,0,"ng-container",19),t.qZA()()(),t.TgZ(14,"div",24)(15,"div",25),t._UZ(16,"ion-icon",26),t.TgZ(17,"div",27)(18,"a",5),t.NdJ("click",function(){t.CHM(o);const u=t.oxw().$implicit,M=t.oxw();return t.KtG(M.deleteConfirmation(u))}),t._uU(19,"Eliminar"),t.qZA(),t.TgZ(20,"a",5),t.NdJ("click",function(){t.CHM(o);const u=t.oxw().$implicit,M=t.oxw();return t.KtG(M.updatePost(u.id))}),t._uU(21,"Editar"),t.qZA()()()()()(),t.TgZ(22,"ion-card-content",5),t.NdJ("click",function(){t.CHM(o);const u=t.oxw().$implicit,M=t.oxw();return t.KtG(M.seePost(u.id))}),t.TgZ(23,"ion-col",28)(24,"ion-slides",29),t.YNc(25,y,3,1,"ng-container",14),t.qZA()(),t.TgZ(26,"div",30)(27,"p",31),t._uU(28),t.qZA(),t.TgZ(29,"p",32),t._uU(30),t.qZA()()()()}if(2&c){const o=t.MAs(8),s=t.oxw().$implicit,u=t.oxw();t.xp6(6),t.Q6J("ngIf",u.hasimage(s))("ngIfElse",o),t.xp6(4),t.Oqu(u.user(s)),t.xp6(2),t.hij("",u.type(s)," "),t.xp6(1),t.Q6J("ngIf",0==s.positive),t.xp6(12),t.Q6J("ngForOf",s.images),t.xp6(3),t.Oqu(s.title),t.xp6(2),t.hij("",u.postText(s.text)," ")}}function D(c,p){if(1&c&&(t.TgZ(0,"ion-card"),t.YNc(1,E,31,8,"div",19),t.qZA()),2&c){const o=p.$implicit,s=t.oxw();t.xp6(1),t.Q6J("ngIf",o.author==s.ownPosts)}}const R=[{path:"",component:(()=>{class c{constructor(o,s,u,M,A,L){this.auth=o,this.router=s,this.avatarService=u,this.loadingController=M,this.alertController=A,this.dataService=L,this.profile=null,this.userLogged=null,this.posts=[],this.ownPosts=null,this.profiles=[],this.profilePicture=null,this.username=null,this.profileuser="",this.dataService.getProfiles().subscribe(b=>{this.profiles=b});const J=(0,v.v0)();(0,v.Aj)(J,b=>{b?(this.avatarService.getUserProfile().subscribe(T=>{this.profile=T,this.ownPosts=T.client.user,this.profileuser=T.client.username}),this.dataService.getPosts().subscribe(T=>{this.posts=T})):(this.router.navigateByUrl("/login",{replaceUrl:!0}),this.showAlert("No hay usuario autenticado","Por favor Inicie sesion"))})}ngOnInit(){}postText(o){return null==o?o:o.length>250?(o=o.substring(0,200))+" ...":o}updatePost(o){console.log("upd click"),this.router.navigate(["/edit-post"],{queryParams:{id:o}})}hasimage(o){for(let s=0;s<this.profiles.length;s++)if(o.author==this.profiles[s].client.user)return this.profilePicture=this.profiles[s].imageURL,!0;return!1}user(o){for(let s=0;s<this.profiles.length;s++)if(o.author==this.profiles[s].client.user)return this.username=this.profiles[s].client.username,this.username;return"Prueba"}type(o){let s="";for(let u=0;u<this.profiles.length;u++)if(o.author==this.profiles[u].client.user)return s=this.profiles[u].client.type,s;return"tipo"}seePost(o){this.router.navigate(["/view-post"],{queryParams:{id:o}})}deletePost(o,s){return(0,P.mG)(this,void 0,void 0,function*(){if(s){const u=yield this.loadingController.create();yield u.present(),yield this.dataService.deletePost(o),yield u.dismiss(),yield this.dataService.getPosts().subscribe(M=>{this.posts=M}),this.Done("Eliminado exitoso","La publicacion se ha eliminado con exito")}})}deleteConfirmation(o){return(0,P.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:"\xbfEstas seguro?",message:"Una vez eliminado, no se podra recuperar",cssClass:"custom-alert",buttons:[{text:"No",handler:()=>this.deletePost(o,!1)},{text:"Si",handler:()=>this.deletePost(o,!0)}]})).present()})}Done(o,s){return(0,P.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:o,message:s,buttons:["OK"]})).present()})}logout(){return(0,P.mG)(this,void 0,void 0,function*(){yield this.auth.logout(),yield this.router.navigateByUrl("",{replaceUrl:!0})})}changeImage(){return(0,P.mG)(this,void 0,void 0,function*(){const o=this.profile,s=yield O.V1.getPhoto({quality:90,allowEditing:!1,resultType:O.dk.Base64,source:O.oK.Photos});if(console.log(s),s){const u=yield this.loadingController.create();yield u.present();const M=yield this.avatarService.uploadPhoto(s,o);u.dismiss(),M||(yield(yield this.alertController.create({header:"Subir imagen Fallo",message:"Hubo un problema al subir tu imagen",buttons:["OK"]})).present())}})}showAlert(o,s){return(0,P.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:o,message:s,buttons:["OK"]})).present()})}editar(){this.router.navigateByUrl("datos-cliente",{replaceUrl:!0})}}return c.\u0275fac=function(o){return new(o||c)(t.Y36(h.e),t.Y36(g.F0),t.Y36(_.o),t.Y36(r.HT),t.Y36(r.Br),t.Y36(a.D))},c.\u0275cmp=t.Xpm({type:c,selectors:[["app-profile"]],decls:27,vars:5,consts:[[3,"translucent"],["id","headerLogo","src","/assets/images/logoHeader.png","size","xs"],["id","headerTitle","align-self-end",""],[1,"profile"],[1,"preview"],[3,"click"],[3,"src",4,"ngIf","ngIfElse"],["placeholder_avatar",""],["id","username"],[1,"buttons"],["name","log-out-outline"],["id","divdiv"],[1,"divider"],[1,"publics"],[4,"ngFor","ngForOf"],[3,"src"],[1,"fallback"],["src","https://t3.ftcdn.net/jpg/03/72/38/88/360_F_372388834_bUf3QEyES2fkPj0D7g0ZBMng2DuSgld7.jpg",1,"profileIcon"],[1,"profileIcontext"],[4,"ngIf"],[1,"row"],[1,"column",3,"click"],[1,"profile2"],[1,"ion-avatar"],[1,"column"],[1,"dropdown"],["name","ellipsis-vertical-outline",1,"dropbtn"],[1,"dropdown-content"],[1,"imgs"],["pager","true","loop","true"],[1,"text"],[1,"title"],[1,"subtitle"]],template:function(o,s){if(1&o&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-row"),t._UZ(3,"ion-img",1),t.TgZ(4,"ion-label",2),t._uU(5,"GeoLocal"),t.qZA()()()(),t.TgZ(6,"ion-content")(7,"div",3)(8,"div",4)(9,"ion-avatar",5),t.NdJ("click",function(){return s.changeImage()}),t.YNc(10,e,1,1,"ion-img",6),t.YNc(11,l,4,0,"ng-template",null,7,t.W1O),t.qZA()(),t.TgZ(13,"div",8)(14,"p"),t._uU(15),t.qZA()(),t.TgZ(16,"div",9)(17,"ion-button",5),t.NdJ("click",function(){return s.editar()}),t.TgZ(18,"p"),t._uU(19,"Editar Perfil"),t.qZA()(),t.TgZ(20,"ion-button",5),t.NdJ("click",function(){return s.logout()}),t._UZ(21,"ion-icon",10),t.qZA()(),t.TgZ(22,"div",11),t._UZ(23,"ion-item-divider",12),t.qZA()(),t.TgZ(24,"div",13)(25,"ion-col"),t.YNc(26,D,2,1,"ion-card",14),t.qZA()()()),2&o){const u=t.MAs(12);t.Q6J("translucent",!0),t.xp6(10),t.Q6J("ngIf",null==s.profile?null:s.profile.imageURL)("ngIfElse",u),t.xp6(5),t.Oqu(s.profileuser),t.xp6(11),t.Q6J("ngForOf",s.posts)}},dependencies:[f.sg,f.O5,r.BJ,r.YG,r.PM,r.FN,r.Zi,r.tO,r.Dq,r.wI,r.W2,r.Gu,r.gu,r.Xz,r.rH,r.Q$,r.Nd,r.A$,r.Hr,r.sr],styles:['#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}#headerTitle[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#ea7622;vertical-align:text-bottom;margin-left:1em;margin-top:1em}#headerLogo[_ngcontent-%COMP%]{height:3em;width:5em}ion-avatar[_ngcontent-%COMP%]{width:128px;height:128px}ion-avatar[_ngcontent-%COMP%]:hover{opacity:.5;font-size:100px;color:#05b736}.preview[_ngcontent-%COMP%]{padding-top:30px;display:flex;justify-content:center}.fallback[_ngcontent-%COMP%]{width:128px;height:128px;border-radius:50%;background:#bfbfbf;font-size:0;display:flex;justify-content:center;align-items:center;font-weight:500}.fallback[_ngcontent-%COMP%]:hover{opacity:.5;font-size:100px;color:#05b736}.profileIcontext[_ngcontent-%COMP%]{position:absolute}#username[_ngcontent-%COMP%]{text-align:center;font-size:20px;font-weight:700}#username[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 10px 10px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:center}#divdiv[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:5px;text-align:center}.divider[_ngcontent-%COMP%]{width:90%}.column[_ngcontent-%COMP%]{float:left;width:50%}.dropbtn[_ngcontent-%COMP%]{padding:10px;font-size:16px;border:none}.dropdown[_ngcontent-%COMP%]{float:right;width:50%;display:flex;justify-content:flex-end}.row[_ngcontent-%COMP%]:after{content:"";display:table;clear:both}.dropdown-content[_ngcontent-%COMP%]{margin-top:40px;display:none;position:absolute;background-color:#f1f1f1;min-width:160px;box-shadow:0 8px 16px #0003;z-index:7}.dropdown-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000;padding:12px 16px;text-decoration:none;display:block}.dropdown-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#ea7622;color:#fff}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown[_ngcontent-%COMP%]:hover   .dropbtn[_ngcontent-%COMP%]{background-color:#bebebe}.ion-avatar[_ngcontent-%COMP%]{width:35px;height:35px}.profile2[_ngcontent-%COMP%]{display:flex}.profile2[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{position:absolute;margin-left:43px;font-size:15px;font-weight:600}.profile2[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{position:absolute;margin-left:43px;font-size:12px;padding-top:20px}ion-card-header[_ngcontent-%COMP%]{padding-bottom:10px}ion-card-content[_ngcontent-%COMP%]{padding:0;margin:0;height:auto}ion-slide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover}.text[_ngcontent-%COMP%]{margin-left:15px;margin-right:15px;padding:5px}.title[_ngcontent-%COMP%]{font-weight:700}.imgs[_ngcontent-%COMP%]{padding:0;margin:0}']}),c})()}];let Z=(()=>{class c{}return c.\u0275fac=function(o){return new(o||c)},c.\u0275mod=t.oAB({type:c}),c.\u0275inj=t.cJS({imports:[g.Bz.forChild(R),g.Bz]}),c})(),I=(()=>{class c{}return c.\u0275fac=function(o){return new(o||c)},c.\u0275mod=t.oAB({type:c}),c.\u0275inj=t.cJS({imports:[f.ez,i.u5,r.Pc,Z]}),c})()},7556:(U,x,n)=>{n.d(x,{e:()=>h});var f=n(655),i=n(7323),r=n(8304),g=n(7311),P=n(2731),O=n(5070),v=n(3562),t=n(2096);let h=(()=>{class _{constructor(e,l){this.auth=e,this.firestore=l}register({email:e,password:l}){return(0,f.mG)(this,void 0,void 0,function*(){try{return yield(0,O.Xb)(this.auth,e,l)}catch(d){return null}})}googleregister(){return(0,f.mG)(this,void 0,void 0,function*(){try{const e=(0,i.v0)(),l=new r.hJ;yield(0,r.F6)(e,l)}catch(e){return null}})}facebookregister(){return(0,f.mG)(this,void 0,void 0,function*(){try{const e=(0,i.v0)(),l=new r._O;yield(0,r.F6)(e,l)}catch(e){return null}})}hasSetup(){return(0,f.mG)(this,void 0,void 0,function*(){const l=(0,i.v0)().currentUser.uid,d=(0,P.hJ)(this.firestore,"users");return(0,P.IO)((0,P.hJ)(d,"users"),(0,P.ar)("user","==",l))?(console.log("false"),()=>(0,g.Y_)(["/app/home"])):()=>(0,g.Y_)(["/user-type"])})}login({email:e,password:l}){return(0,f.mG)(this,void 0,void 0,function*(){try{return yield(0,i.e5)(this.auth,e,l)}catch(d){return console.log("error Login: "+d),d}})}googleLogin(){return(0,f.mG)(this,void 0,void 0,function*(){try{const e=(0,i.v0)(),l=new r.hJ;yield(0,r.F6)(e,l)}catch(e){return null}})}facebookLogin(){return(0,f.mG)(this,void 0,void 0,function*(){try{const e=(0,i.v0)(),l=new r._O;yield(0,r.F6)(e,l)}catch(e){return null}})}logout(){return(0,O.w7)(this.auth)}getUserType(e){return(0,f.mG)(this,void 0,void 0,function*(){const l=(0,v.JU)(this.firestore,`users/${e}`);let d=null;(0,v.QT)(l).then(m=>(console.log(m.data(),m.id),d=m.data(),d.type))})}}return _.\u0275fac=function(e){return new(e||_)(t.LFG(i.gx),t.LFG(v.gg))},_.\u0275prov=t.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},5083:(U,x,n)=>{n.d(x,{o:()=>O});var f=n(655),i=n(3562),r=n(6180),g=n(2096),P=n(7323);let O=(()=>{class v{constructor(h,_,a){this.auth=h,this.firestore=_,this.storage=a}getUserProfile(){const _=(0,i.JU)(this.firestore,`users/${this.auth.currentUser.uid}`);return(0,i._1)(_)}getUserProfileWId(h){const a=(0,i.JU)(this.firestore,`users/${h}`);return(0,i._1)(a)}uploadPhoto(h,_){return(0,f.mG)(this,void 0,void 0,function*(){const a=yield this.auth.currentUser,l=(0,r.iH)(this.storage,`uploads/${a.uid}/profile.png`);try{yield(0,r.sf)(l,h.base64String,"base64");const d=yield(0,r.Jt)(l),m=(0,i.JU)(this.firestore,`users/${a.uid}`);return yield(0,i.r7)(m,{imageURL:d}),!0}catch(d){return console.log(d),null}})}}return v.\u0275fac=function(h){return new(h||v)(g.LFG(P.gx),g.LFG(i.gg),g.LFG(r.Ke))},v.\u0275prov=g.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})()},2468:(U,x,n)=>{n.d(x,{D:()=>t});var f=n(655),i=n(3562),r=n(6180),g=n(6961),P=n(5525),O=n(2096),v=n(7323);let t=(()=>{class h{constructor(a,e,l){this.firestore=a,this.auth=e,this.storage=l}getPosts(){const a=(0,i.hJ)(this.firestore,"posts");return(0,i.BS)(a,{idField:"id"})}getUsers(){const a=(0,i.hJ)(this.firestore,"posts");return(0,i.BS)(a,{idField:"id"})}getProfiles(){const a=(0,i.hJ)(this.firestore,"users");return(0,i.BS)(a,{idField:"user"})}getPostById(a){let e;const l=(0,i.JU)(this.firestore,`posts/${a}`);let d=(0,i._1)(l,{idField:"id"});return e.author=d.author,e.id=d.id,e.images=d.images,e.pos=d.pos,e.positive=d.positive,e.text=d.text,e.title=d.title,e}addPost(a){const e=(0,i.hJ)(this.firestore,"posts");return(0,i.ET)(e,a)}addPostGetId(a){const e=(0,i.hJ)(this.firestore,"posts");return(0,i.ET)(e,a).then(d=>(console.log(d.id),d.id))}deletePost(a){const e=(0,i.JU)(this.firestore,`posts/${a.id}`);return(0,i.oe)(e)}deleteImage(a){for(let l=0;l<a.images.length;l++)console.log(a.images[l])}updatePost(a){const e=(0,i.JU)(this.firestore,`posts/${a.id}`);return(0,i.r7)(e,{title:a.title,text:a.text,positive:a.positive})}uploadPhoto(a){return(0,f.mG)(this,void 0,void 0,function*(){let e;const C=(0,r.iH)(this.storage,`uploads/${this.auth.currentUser.uid}/photo.png`);try{yield(0,g.sf)(C,a.base64String,"base64"),e=[yield(0,g.Jt)(C)];const E=(0,i.JU)(this.firestore,"posts/bvSZeSKsuk6Ea95M6ytv");return yield(0,P.pl)(E,{images:e}),!0}catch(y){return console.log(y),null}})}uploadPhotoWId(a,e){return(0,f.mG)(this,void 0,void 0,function*(){let l;const m=e,y=(0,r.iH)(this.storage,`uploads/${this.auth.currentUser.uid}/${m}/photo.png`);try{yield(0,g.sf)(y,a.base64String,"base64"),l=[yield(0,g.Jt)(y)];const D=(0,i.JU)(this.firestore,`posts/${m}`);return yield(0,i.r7)(D,{images:l}),!0}catch(E){return console.log(E),null}})}getImagesArray(a){return(0,f.mG)(this,void 0,void 0,function*(){let e;const C=(0,r.iH)(this.storage,`uploads/${this.auth.currentUser.uid}/photo.png`);try{return yield(0,g.sf)(C,a.base64String,"base64"),e=[yield(0,g.Jt)(C)],e}catch(y){return console.log(y),null}})}getDoc(a){return(0,f.mG)(this,void 0,void 0,function*(){const e=(0,i.JU)(this.firestore,`posts/${a}`);let l=null;(0,i.QT)(e).then(d=>(console.log(d.data(),d.id),l=d.data(),l))})}}return h.\u0275fac=function(a){return new(a||h)(O.LFG(i.gg),O.LFG(v.gx),O.LFG(r.Ke))},h.\u0275prov=O.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()}}]);