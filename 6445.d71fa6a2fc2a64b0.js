"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6445],{6445:(C,U,r)=>{r.r(U),r.d(U,{MapPageModule:()=>u});var y=r(9808),i=r(4182),c=r(7590),g=r(7733),P=r(655),R=r(3742),E=r(2340),s=r(2096),p=r(2468),L=r(3562),t=r(7323);const e=["map"],a=[],v=[{path:"",component:(()=>{class o{constructor(n,M,d,h,D,O){this.loadingController=n,this.data=M,this.alert=d,this.firestore=h,this.auth=D,this.dataService=O,this.lt=[],this.lon=[],this.userType=null,this.profiles=[],this.myPosition={},this.markers=[],this.c=0,this.string=[],this.createMap()}ngOnInit(){}ionViewDidEnter(){}createMap(){return(0,P.mG)(this,void 0,void 0,function*(){const n=yield this.loadingController.create();yield n.present(),this.map=yield R.b.create({id:"map",apiKey:E.N.mapsKey,element:this.mapRef.nativeElement,config:{center:{lat:21.5095,lng:-104.8957},zoom:14,minZoom:5}}),this.dataService.getProfiles().subscribe(M=>{this.profiles=M;for(let d=0;d<this.profiles.length;d++)if(null!=this.profiles[d].client.latitude&&null!=this.profiles[d].client.longitude){const h={coordinate:{lat:Number(this.profiles[d].client.latitude),lng:Number(this.profiles[d].client.longitude)},title:"Restaurant: "+this.profiles[d].client.username};this.markers.push(h),console.log(h)}else console.log("no hay");console.log("markers",this.markers),this.map.addMarkers(this.markers),this.map.setOnMarkerClickListener(d=>(0,P.mG)(this,void 0,void 0,function*(){const h=yield this.alert.create({header:"Ubicaci\xf2n",message:d.title+"\nLatitud: "+d.latitude+"    Longitud: "+d.longitude,buttons:["OK"]});yield h.present();let D=yield h.onDidDismiss();console.log(D)}))}),yield n.dismiss()})}addMarkers(n,M){return(0,P.mG)(this,void 0,void 0,function*(){this.markers=[{coordinate:{lat:n,lng:M},title:"Coordenadas",snippet:"Best place on earth"}],yield this.map.addMarkers(a),this.c++,this.map.setOnMarkerClickListener(d=>(0,P.mG)(this,void 0,void 0,function*(){const h=yield this.alert.create({header:"Ubicaci\xf2n",message:d.title+"\nLatitud: "+d.latitude+"    Longitud: "+d.longitude,buttons:["OK"]});yield h.present();let D=yield h.onDidDismiss();console.log(D)}))})}getCoordenadas(){}generaMarkers(){for(let n=0;n<this.profiles.length;n++)this.marcadores[n]="{\ncoordinate: {\nlat:"+this.profiles[n].client.latitude+",\nlng:"+this.profiles[n].client.longitude+",\n},\ntitle: 'Coordenadas',\nsnippet:'Best place on earth',\n},"}}return o.\u0275fac=function(n){return new(n||o)(s.Y36(c.HT),s.Y36(p.D),s.Y36(c.Br),s.Y36(L.gg),s.Y36(t.gx),s.Y36(p.D))},o.\u0275cmp=s.Xpm({type:o,selectors:[["app-map"]],viewQuery:function(n,M){if(1&n&&s.Gf(e,5),2&n){let d;s.iGM(d=s.CRH())&&(M.mapRef=d.first)}},decls:10,vars:1,consts:[[3,"translucent"],["id","headerLogo","src","/assets/images/logoHeader.png","size","xs"],["id","headerTitle","align-self-end",""],[1,"container"],["id","mapContainer"],["map",""]],template:function(n,M){1&n&&(s.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-row"),s._UZ(3,"ion-img",1),s.TgZ(4,"ion-label",2),s._uU(5,"GeoLocal"),s.qZA()()()(),s.TgZ(6,"ion-content")(7,"div",3),s._UZ(8,"capacitor-google-map",4,5),s.qZA()()),2&n&&s.Q6J("translucent",!0)},dependencies:[c.W2,c.Gu,c.Xz,c.Q$,c.Nd,c.sr],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%}#headerTitle[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#ea7622;vertical-align:text-bottom;margin-left:1em;margin-top:1em}#headerLogo[_ngcontent-%COMP%]{height:3em;width:5em}#mapContainer[_ngcontent-%COMP%]{display:inline-block;width:100%;height:100%}"]}),o})()}];let f=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=s.oAB({type:o}),o.\u0275inj=s.cJS({imports:[g.Bz.forChild(v),g.Bz]}),o})(),u=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=s.oAB({type:o}),o.\u0275inj=s.cJS({imports:[y.ez,i.u5,c.Pc,f]}),o})()},2468:(C,U,r)=>{r.d(U,{D:()=>s});var y=r(655),i=r(3562),c=r(6180),g=r(6961),P=r(5525),R=r(2096),E=r(7323);let s=(()=>{class p{constructor(t,e,a){this.firestore=t,this.auth=e,this.storage=a}getPosts(){const t=(0,i.hJ)(this.firestore,"posts");return(0,i.BS)(t,{idField:"id"})}getUsers(){const t=(0,i.hJ)(this.firestore,"posts");return(0,i.BS)(t,{idField:"id"})}getProfiles(){const t=(0,i.hJ)(this.firestore,"users");return(0,i.BS)(t,{idField:"user"})}getPostById(t){let e;const a=(0,i.JU)(this.firestore,`posts/${t}`);let l=(0,i._1)(a,{idField:"id"});return e.author=l.author,e.id=l.id,e.images=l.images,e.pos=l.pos,e.positive=l.positive,e.text=l.text,e.title=l.title,e}addPost(t){const e=(0,i.hJ)(this.firestore,"posts");return(0,i.ET)(e,t)}addPostGetId(t){const e=(0,i.hJ)(this.firestore,"posts");return(0,i.ET)(e,t).then(l=>(console.log(l.id),l.id))}deletePost(t){const e=(0,i.JU)(this.firestore,`posts/${t.id}`);return(0,i.oe)(e)}deleteImage(t){for(let a=0;a<t.images.length;a++)console.log(t.images[a])}updatePost(t){const e=(0,i.JU)(this.firestore,`posts/${t.id}`);return(0,i.r7)(e,{title:t.title,text:t.text,positive:t.positive})}uploadPhoto(t){return(0,y.mG)(this,void 0,void 0,function*(){let e;const f=(0,c.iH)(this.storage,`uploads/${this.auth.currentUser.uid}/photo.png`);try{yield(0,g.sf)(f,t.base64String,"base64"),e=[yield(0,g.Jt)(f)];const o=(0,i.JU)(this.firestore,"posts/bvSZeSKsuk6Ea95M6ytv");return yield(0,P.pl)(o,{images:e}),!0}catch(u){return console.log(u),null}})}uploadPhotoWId(t,e){return(0,y.mG)(this,void 0,void 0,function*(){let a;const v=e,u=(0,c.iH)(this.storage,`uploads/${this.auth.currentUser.uid}/${v}/photo.png`);try{yield(0,g.sf)(u,t.base64String,"base64"),a=[yield(0,g.Jt)(u)];const m=(0,i.JU)(this.firestore,`posts/${v}`);return yield(0,i.r7)(m,{images:a}),!0}catch(o){return console.log(o),null}})}getImagesArray(t){return(0,y.mG)(this,void 0,void 0,function*(){let e;const f=(0,c.iH)(this.storage,`uploads/${this.auth.currentUser.uid}/photo.png`);try{return yield(0,g.sf)(f,t.base64String,"base64"),e=[yield(0,g.Jt)(f)],e}catch(u){return console.log(u),null}})}getDoc(t){return(0,y.mG)(this,void 0,void 0,function*(){const e=(0,i.JU)(this.firestore,`posts/${t}`);let a=null;(0,i.QT)(e).then(l=>(console.log(l.data(),l.id),a=l.data(),a))})}}return p.\u0275fac=function(t){return new(t||p)(R.LFG(i.gg),R.LFG(E.gx),R.LFG(c.Ke))},p.\u0275prov=R.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()}}]);