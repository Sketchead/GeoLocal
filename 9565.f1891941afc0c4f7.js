"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9565],{6090:(G,v,r)=>{r.d(v,{b:()=>c});const c=(0,r(7423).fo)("Geolocation",{web:()=>r.e(4561).then(r.bind(r,4561)).then(a=>new a.GeolocationWeb)})},9565:(G,v,r)=>{r.r(v),r.d(v,{HomeGuestPageModule:()=>N});var p=r(9808),c=r(4182),a=r(7590),h=r(7733),x=r(655),M=r(6090),t=r(2096),Z=r(2468),m=r(7323),b=r(3562);function i(n,l){if(1&n&&t._UZ(0,"ion-img",16),2&n){const e=t.oxw(3);t.Q6J("src",e.profilePicture)}}function s(n,l){1&n&&(t.TgZ(0,"div",17),t._UZ(1,"img",18)(2,"p",19),t.qZA())}function u(n,l){1&n&&(t.ynx(0),t._UZ(1,"ion-icon",20),t.BQk())}function g(n,l){1&n&&(t.ynx(0),t.TgZ(1,"ion-chip",21)(2,"ion-label"),t._uU(3,"Recomendado"),t.qZA()(),t.BQk())}function P(n,l){1&n&&(t.ynx(0),t.TgZ(1,"ion-chip",22)(2,"ion-label"),t._uU(3,"No Recomendado"),t.qZA()(),t.BQk())}function _(n,l){if(1&n&&(t.ynx(0),t.TgZ(1,"ion-slide"),t._UZ(2,"img",16),t.qZA(),t.BQk()),2&n){const e=l.$implicit;t.xp6(2),t.s9C("src",e,t.LSH)}}function f(n,l){if(1&n&&(t.ynx(0),t.TgZ(1,"ion-card")(2,"ion-card-header")(3,"div",6)(4,"div",7)(5,"div",8)(6,"ion-avatar"),t.YNc(7,i,1,1,"ion-img",9),t.YNc(8,s,3,0,"ng-template",null,10,t.W1O),t.qZA(),t.TgZ(10,"ion-card-title"),t._uU(11),t.qZA(),t.TgZ(12,"ion-card-subtitle"),t._uU(13),t.YNc(14,u,2,0,"ng-container",5),t.qZA()(),t.YNc(15,g,4,0,"ng-container",5),t.YNc(16,P,4,0,"ng-container",5),t.qZA()()(),t.TgZ(17,"ion-card-content")(18,"ion-col",11)(19,"ion-slides",12),t.YNc(20,_,3,1,"ng-container",4),t.qZA()(),t.TgZ(21,"div",13)(22,"p",14),t._uU(23),t.qZA(),t.TgZ(24,"p",15),t._uU(25),t.qZA()()()(),t.BQk()),2&n){const e=t.MAs(9),o=t.oxw().$implicit,d=t.oxw();t.xp6(7),t.Q6J("ngIf",d.hasimage(o))("ngIfElse",e),t.xp6(4),t.Oqu(d.user(o)),t.xp6(2),t.hij("",d.type(o)," "),t.xp6(1),t.Q6J("ngIf",0==o.positive),t.xp6(1),t.Q6J("ngIf",1==o.positive),t.xp6(1),t.Q6J("ngIf",0==o.positive),t.xp6(4),t.Q6J("ngForOf",o.images),t.xp6(3),t.Oqu(o.title),t.xp6(2),t.hij("",d.postText(o.text)," ")}}function y(n,l){if(1&n&&t._UZ(0,"ion-img",16),2&n){const e=t.oxw(3);t.Q6J("src",e.profilePicture)}}function T(n,l){1&n&&(t.TgZ(0,"div",17),t._UZ(1,"img",18)(2,"p",19),t.qZA())}function B(n,l){1&n&&t.GkF(0)}function L(n,l){if(1&n&&(t.ynx(0),t.TgZ(1,"ion-slide"),t._UZ(2,"img",16),t.qZA(),t.BQk()),2&n){const e=l.$implicit;t.xp6(2),t.s9C("src",e,t.LSH)}}function Q(n,l){if(1&n&&(t.ynx(0),t.TgZ(1,"ion-card",23)(2,"ion-card-header")(3,"div",6)(4,"div",7)(5,"div",8)(6,"ion-avatar"),t.YNc(7,y,1,1,"ion-img",9),t.YNc(8,T,3,0,"ng-template",null,10,t.W1O),t.qZA(),t.TgZ(10,"ion-card-title"),t._uU(11),t.qZA(),t.TgZ(12,"ion-card-subtitle"),t._uU(13),t.YNc(14,B,1,0,"ng-container",5),t.qZA()()()()(),t.TgZ(15,"ion-card-content")(16,"ion-col",11)(17,"ion-slides",12),t.YNc(18,L,3,1,"ng-container",4),t.qZA()(),t.TgZ(19,"div",13)(20,"p",14),t._uU(21),t.qZA(),t.TgZ(22,"p",15),t._uU(23),t.qZA()()()(),t.BQk()),2&n){const e=t.MAs(9),o=t.oxw().$implicit,d=t.oxw();t.xp6(7),t.Q6J("ngIf",d.hasimage(o))("ngIfElse",e),t.xp6(4),t.Oqu(d.user(o)),t.xp6(2),t.hij("",d.type(o)," "),t.xp6(1),t.Q6J("ngIf",0==o.positive),t.xp6(4),t.Q6J("ngForOf",o.images),t.xp6(3),t.Oqu(o.title),t.xp6(2),t.hij("",d.postText(o.text)," ")}}function S(n,l){if(1&n&&(t.ynx(0),t.YNc(1,f,26,10,"ng-container",5),t.YNc(2,Q,24,8,"ng-container",5),t.BQk()),2&n){const e=l.$implicit;t.xp6(1),t.Q6J("ngIf","publicity"!=e.type),t.xp6(1),t.Q6J("ngIf","publicity"==e.type)}}const Y=[{path:"",component:(()=>{class n{constructor(e,o,d,U,$,w){this.router=e,this.dataService=o,this.auth=d,this.alertController=U,this.loadingController=$,this.firestore=w,this.userLogged=null,this.posts=[],this.profiles=[],this.profilePicture=null,this.username=null,this.userType=null,this.pos=[1,2],this.nearbyPosts=[],this.dataService.getPosts().subscribe(O=>{this.posts=O,(()=>{(0,x.mG)(this,void 0,void 0,function*(){this.nearbyPosts=[];const R=yield M.b.getCurrentPosition();this.pos[0]=R.coords.latitude,this.pos[1]=R.coords.longitude;for(let C=0;C<this.posts.length;C++){console.log("Lat:",this.pos[0]),console.log("Lon:",this.pos[1]);var A=O[C].pos[0],z=O[C].pos[1],E=this.pos[0],W=this.pos[1],I=this.toRad(A-E),D=this.toRad(z-W),H=Math.sin(I/2)*Math.sin(I/2)+Math.cos(this.toRad(E))*Math.cos(this.toRad(A))*Math.sin(D/2)*Math.sin(D/2),J=2*Math.atan2(Math.sqrt(H),Math.sqrt(1-H))*6371;console.log("DISTANCIA: ",J),J<5&&this.nearbyPosts.push(O[C])}console.log(this.nearbyPosts)})})()}),this.dataService.getProfiles().subscribe(O=>{this.profiles=O})}postText(e){return null==e?e:e.length>250?(e=e.substring(0,200))+" ...":e}hasimage(e){for(let o=0;o<this.profiles.length;o++)if(e.author==this.profiles[o].client.user)return this.profilePicture=this.profiles[o].imageURL,!0;return!1}user(e){for(let o=0;o<this.profiles.length;o++)if(e.author==this.profiles[o].client.user)return this.username=this.profiles[o].client.username,this.username;return"Prueba"}type(e){let o="";for(let d=0;d<this.profiles.length;d++)if(e.author==this.profiles[d].client.user)return o=this.profiles[d].client.type,o;return"tipo"}seePost(e){this.router.navigate(["/view-post"],{queryParams:{id:e}})}seeProfile(e){e==this.userLogged?this.router.navigate(["/app/profile"]):this.router.navigate(["/view-profile"],{queryParams:{id:e}})}updatePost(e){console.log("upd click"),this.router.navigate(["/edit-post"],{queryParams:{id:e}})}createPost(){this.router.navigate(["/create-post"])}createPublicity(){this.router.navigate(["/create-publicity-post"])}deletePost(e,o){return(0,x.mG)(this,void 0,void 0,function*(){if(o){const d=yield this.loadingController.create();yield d.present(),yield this.dataService.deletePost(e),yield d.dismiss(),yield this.dataService.getPosts().subscribe(U=>{this.posts=U}),this.Done("Eliminado exitoso","La publicacion se ha eliminado con exito")}})}deleteConfirmation(e){return(0,x.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:"\xbfEstas seguro?",message:"Una vez eliminado, no se podra recuperar",cssClass:"custom-alert",buttons:[{text:"No",handler:()=>this.deletePost(e,!1)},{text:"Si",handler:()=>this.deletePost(e,!0)}]})).present()})}Done(e,o){return(0,x.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:e,message:o,buttons:["OK"]})).present()})}toRad(e){return e*Math.PI/180}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h.F0),t.Y36(Z.D),t.Y36(m.gx),t.Y36(a.Br),t.Y36(a.HT),t.Y36(b.gg))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-home-guest"]],decls:9,vars:3,consts:[[3,"translucent"],["id","headerLogo","src","/assets/images/logoHeader.png","size","xs"],["id","headerTitle","align-self-end",""],[3,"fullscreen"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"row"],[1,"column"],[1,"profile"],[3,"src",4,"ngIf","ngIfElse"],["placeholder_avatar",""],[1,"imgs"],["pager","true","loop","true"],[1,"text"],[1,"title"],[1,"subtitle"],[3,"src"],[1,"fallback"],["src","https://t3.ftcdn.net/jpg/03/72/38/88/360_F_372388834_bUf3QEyES2fkPj0D7g0ZBMng2DuSgld7.jpg",1,"profileIcon"],[1,"profileIcontext"],["name","thumbs-up-outline"],["color","success"],["color","danger"],["color","medium"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-row"),t._UZ(3,"ion-img",1),t.TgZ(4,"ion-label",2),t._uU(5,"GeoLocal"),t.qZA()()()(),t.TgZ(6,"ion-content",3)(7,"ion-col"),t.YNc(8,S,3,2,"ng-container",4),t.qZA()()),2&e&&(t.Q6J("translucent",!0),t.xp6(6),t.Q6J("fullscreen",!0),t.xp6(2),t.Q6J("ngForOf",o.nearbyPosts))},dependencies:[p.sg,p.O5,a.BJ,a.PM,a.FN,a.Zi,a.tO,a.Dq,a.hM,a.wI,a.W2,a.Gu,a.gu,a.Xz,a.Q$,a.Nd,a.A$,a.Hr,a.sr],styles:['#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:50%;transform:translateY(-50%)}#container[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:20px;line-height:26px}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}#headerTitle[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#ea7622;vertical-align:text-bottom;margin-left:1em;margin-top:1em}#headerLogo[_ngcontent-%COMP%]{height:3em;width:5em}.column[_ngcontent-%COMP%]{float:left;width:50%}.dropbtn[_ngcontent-%COMP%]{padding:10px;font-size:16px;border:none}.dropdown[_ngcontent-%COMP%]{float:right;width:50%;display:flex;justify-content:flex-end}.row[_ngcontent-%COMP%]:after{content:"";display:table;clear:both}.dropdown-content[_ngcontent-%COMP%]{margin-top:40px;display:none;position:absolute;background-color:#f1f1f1;min-width:160px;box-shadow:0 8px 16px #0003;z-index:7}.dropdown-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000;padding:12px 16px;text-decoration:none;display:block}.dropdown-content[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#ea7622;color:#fff}.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%]{display:block}.dropdown[_ngcontent-%COMP%]:hover   .dropbtn[_ngcontent-%COMP%]{background-color:#bebebe}ion-avatar[_ngcontent-%COMP%]{width:35px;height:35px}.profile[_ngcontent-%COMP%]{display:flex}.profile[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{position:absolute;margin-left:43px;font-size:15px;font-weight:600}.profile[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{position:absolute;margin-left:43px;font-size:12px;padding-top:20px}ion-card-header[_ngcontent-%COMP%]{padding-bottom:10px}ion-card-content[_ngcontent-%COMP%]{padding:0;height:auto}ion-slide[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover}.text[_ngcontent-%COMP%]{margin-left:15px;margin-right:15px;padding:5px}.title[_ngcontent-%COMP%]{font-weight:700}.imgs[_ngcontent-%COMP%]{padding:0;margin:0}input[_ngcontent-%COMP%]{padding-bottom:0}']}),n})()}];let F=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[h.Bz.forChild(Y),h.Bz]}),n})(),N=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.ez,c.u5,a.Pc,F]}),n})()},2468:(G,v,r)=>{r.d(v,{D:()=>Z});var p=r(655),c=r(3562),a=r(6180),h=r(6961),x=r(5525),M=r(2096),t=r(7323);let Z=(()=>{class m{constructor(i,s,u){this.firestore=i,this.auth=s,this.storage=u}getPosts(){const i=(0,c.hJ)(this.firestore,"posts");return(0,c.BS)(i,{idField:"id"})}getUsers(){const i=(0,c.hJ)(this.firestore,"posts");return(0,c.BS)(i,{idField:"id"})}getProfiles(){const i=(0,c.hJ)(this.firestore,"users");return(0,c.BS)(i,{idField:"user"})}getPostById(i){let s;const u=(0,c.JU)(this.firestore,`posts/${i}`);let g=(0,c._1)(u,{idField:"id"});return s.author=g.author,s.id=g.id,s.images=g.images,s.pos=g.pos,s.positive=g.positive,s.text=g.text,s.title=g.title,s}addPost(i){const s=(0,c.hJ)(this.firestore,"posts");return(0,c.ET)(s,i)}addPostGetId(i){const s=(0,c.hJ)(this.firestore,"posts");return(0,c.ET)(s,i).then(g=>(console.log(g.id),g.id))}deletePost(i){const s=(0,c.JU)(this.firestore,`posts/${i.id}`);return(0,c.oe)(s)}deleteImage(i){for(let u=0;u<i.images.length;u++)console.log(i.images[u])}updatePost(i){const s=(0,c.JU)(this.firestore,`posts/${i.id}`);return(0,c.r7)(s,{title:i.title,text:i.text,positive:i.positive})}uploadPhoto(i){return(0,p.mG)(this,void 0,void 0,function*(){let s;const _=(0,a.iH)(this.storage,`uploads/${this.auth.currentUser.uid}/photo.png`);try{yield(0,h.sf)(_,i.base64String,"base64"),s=[yield(0,h.Jt)(_)];const y=(0,c.JU)(this.firestore,"posts/bvSZeSKsuk6Ea95M6ytv");return yield(0,x.pl)(y,{images:s}),!0}catch(f){return console.log(f),null}})}uploadPhotoWId(i,s){return(0,p.mG)(this,void 0,void 0,function*(){let u;const P=s,f=(0,a.iH)(this.storage,`uploads/${this.auth.currentUser.uid}/${P}/photo.png`);try{yield(0,h.sf)(f,i.base64String,"base64"),u=[yield(0,h.Jt)(f)];const T=(0,c.JU)(this.firestore,`posts/${P}`);return yield(0,c.r7)(T,{images:u}),!0}catch(y){return console.log(y),null}})}getImagesArray(i){return(0,p.mG)(this,void 0,void 0,function*(){let s;const _=(0,a.iH)(this.storage,`uploads/${this.auth.currentUser.uid}/photo.png`);try{return yield(0,h.sf)(_,i.base64String,"base64"),s=[yield(0,h.Jt)(_)],s}catch(f){return console.log(f),null}})}getDoc(i){return(0,p.mG)(this,void 0,void 0,function*(){const s=(0,c.JU)(this.firestore,`posts/${i}`);let u=null;(0,c.QT)(s).then(g=>(console.log(g.data(),g.id),u=g.data(),u))})}}return m.\u0275fac=function(i){return new(i||m)(M.LFG(c.gg),M.LFG(t.gx),M.LFG(a.Ke))},m.\u0275prov=M.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()}}]);